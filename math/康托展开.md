
康托展开用于将一个排列映射为一个唯一的整数，或者从一个整数恢复其对应的排列，常用于解决排列相关的计数问题
# 康托展开基于排列的字典序位置。

$$
假设我们有一个长度为 n 的排列  a=(a_1,a_2,\dots,a_n),  其中a_i各不相同
$$
康托展开的公式如下：
$$
Rank(a) = \sum_{i = 1}^n c_i \cdot (n - i)!
$$

其中：
- $c_i$​ 表示排列中 $a_i$​ 在当前未使用数字中的排名（从0开始计数）。
- (n−i)!是剩余位置的排列数。

## 事例（GPT生成的）
对于排列 a=(3,1,4,2)a=(3,1,4,2)：

1. 未使用数字为 {1,2,3,4}{1,2,3,4}：
    - a1=3a1​=3，比3小的有2个，c1=2c1​=2。
    - a2=1a2​=1，比1小的有0个，c2=0c2​=0。
    - a3=4a3​=4，比4小的有2个，c3=2c3​=2。
    - a4=2a4​=2，比2小的有0个，c4=0c4​=0。
2. 康托展开为：Rank(a)=2⋅3!+0⋅2!+2⋅1!+0⋅0!=12+0+2+0=14
# 逆康托展开
因为双射，所以有一一对应

假设 n=4，排名 r=14：

1. r=14r，未使用数字为 {1,2,3,4}：
    - c1=⌊14/3!⌋=2c1​=⌊14/3!⌋=2，选择第2小的数字 33。
    - 更新 r=14mod  6=2。
2. r=2，未使用数字为 {1,2,4}：
    - c2=⌊2/2!⌋=0c，选择第0小的数字 1。
    - 更新 r=2mod  2=0。
3. r=0，未使用数字为 {2,4}：
    - c3=⌊0/1!⌋=0，选择第0小的数字 4。
    - 更新 r=0mod  1=0。
4. r=0，未使用数字为 {2}：
    - 选择最后一个数字 2。

结果排列为 a=(3,1,4,2)。

非常适合写递归~~~~不是~~


### 有重复的去重

$$
Rank(a) = \sum_{i = 1}^n \frac{c_i \cdot (n - i)!}{\prod_{k = 1}^m f_k}
$$